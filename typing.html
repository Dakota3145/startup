<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="https://cdn-icons-png.flaticon.com/512/1184/1184161.png"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="index.css" />

    <title>The Typing Game</title>
  </head>
  <body>
    <header>
      <img
        src="https://img.uxwing.com/wp-content/themes/uxwing/download/web-app-development/typing-icon.svg"
        width="100"
      />
      <h1>The Typing Game</h1>
      <h2>Dakota Stevens</h2>
    </header>
    <main>
      <div class="wrapper">
        <div class="logout">
          <a class="btn btn-primary" href="/" role="button">Dave - Logout</a>
        </div>
        <div class="leaderboard">
          <p>Leaderboard</p>
          <!-- <ol>
            <li>Henry: 45 WPM</li>
            <li>Sam: 40 WPM</li>
            <li>Josh: 35 WPM</li>
            <li>Sarah: 30 WPM</li>
            <li>Jeremy: 20 WPM</li>
          </ol> -->
          <ol id="leaderboard"></ol>
        </div>
        <form id="myform" class="level" onsubmit="showModal()">
          <p>Level: 30 WPM</p>
          <p>Jack and Jill ran up a hill to fetch a pail of water</p>
          <p id="demo"></p>
          <input type="text" id="typeInput" placeholder="Type Here" value="" />
          <button type="submit" class="btn btn-primary">Check Input</button>
        </form>
        <div class="notifications">
          <p>Notifications</p>
          <ul>
            <li>Sarah just got 30 WPM!</li>
            <li id="notification">Jeremy just got 20 WPM!</li>
          </ul>
        </div>
      </div>
    </main>
    <footer>
      <a class="btn btn-primary" href="https://github.com/Dakota3145/startup" role="button">Check out the Source Code Here</a>
    </footer>
    <script>
      function showModal(event = null) {
        if (event != null) {
          event.preventDefault();
        }
        const inputVal = document.querySelector('#typeInput').value;
        console.log("input Value: ", inputVal);
        var modalEl;
        if (inputVal != null && inputVal == 'Jack and Jill ran up a hill to fetch a pail of water') {
          modalEl = document.querySelector('#msgModalPassed');
        }
        else {
          modalEl = document.querySelector('#msgModalFailed');
        }
        const msgModal = new bootstrap.Modal(modalEl, {});
        msgModal.show();
      }

      var myform = document.getElementById("myform");
      myform.addEventListener("submit", showModal);

      // function refreshPage() {
      //   location.reload();
      // }

      function changeLevel() {
        //TODO: change html inner text of the typing level
      }

            // Set the date we're counting down to
      var curr = new Date().getTime();
      numSeconds = 22;
      var countDownDate = new Date(curr + numSeconds*1000);

      // Update the count down every 1 second
      var x = setInterval(function() {

        // Get today's date and time
        var now = new Date().getTime();
          
        // Find the distance between now and the count down date
        var distance = countDownDate - now;
          
        // Time calculations for days, hours, minutes and seconds
        var seconds = Math.floor((distance % (1000 * 60)) / 1000);
          
        // Output the result in an element with id="demo"
        document.getElementById("demo").innerHTML = seconds + "s ";

        if (seconds == 10) {
          replaceLeaderboard();
        }
          
        // If the count down is over, write some text 
        if (distance < 0) {
          clearInterval(x);
          document.getElementById("demo").innerHTML = "EXPIRED";
          showModal();
        }

      }, 1000);


      let data = ["Henry: 45 WPM", "Sam: 40 WPM", "Josh: 35 WPM", "Sarah: 30 WPM"];
      let list = document.getElementById("leaderboard");
      for (i = 0; i < data.length; ++i) {
        var li = document.createElement('li');
        li.innerText = data[i];
        list.appendChild(li);
      }

      function replaceLeaderboard() {
        let list = document.getElementById("leaderboard");
        var li = document.createElement('li');
        li.innerText = "Jeremy: 20 WPM";
        list.appendChild(li);
      }

    </script>

    <!-- modal passed dialog -->
    <div class="modal fade" id="msgModalPassed" tabindex="-1">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content text-dark">
          <div class="modal-body">Passed! Your input matched the given text. Click close to start the next level</div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" onClick="changeLevel()">Close</button>
          </div>
        </div>
      </div>
    </div>

    <div class="modal fade" id="msgModalFailed" tabindex="-1">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content text-dark">
          <div class="modal-body">Missed! Your input didn't match the given text. Click close to start over</div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" onClick="changeLevel()">Close</button>
          </div>
        </div>
      </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
